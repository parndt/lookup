TODO:
Test the bloody thing.